{% extends "layouts/base.njk" %}

{% block content %}
<section class="product-page">
  <div class="container">

    {# ===============================
       FEATURED PRODUCT IMAGE
       (uses images[0])
       =============================== #}
    {% if images and images.length %}
      <div class="product-featured-image">
        <img
          src="{{ images[0] }}"
          alt="{{ title }}"
          loading="eager"
        >
      </div>
    {% endif %}

<p style="color:red; font-weight:bold;">
  DEBUG gallery length: {{ gallery | length }}
</p>

    {# ===============================
       PRODUCT GALLERY (Phase 3A)
       (uses gallery[])
       =============================== #}
    {% if gallery and gallery.length %}
      <section class="product-gallery-section">
        <div class="product-gallery-grid">
          {% for image in gallery %}
            <div class="product-gallery-item">
              <img
                src="{{ image }}"
                alt="{{ title }} gallery image {{ loop.index }}"
                loading="lazy"
              >
            </div>
          {% endfor %}
        </div>
      </section>
    {% endif %}

    {# ===============================
       PRODUCT CONTENT
       =============================== #}
    <div class="prose max-w-none product-content">
      {{ content | safe }}
    </div>

  </div>
</section>
{% endblock %}

<style>
/* ===============================
   PRODUCT FEATURED IMAGE
   =============================== */
.product-featured-image {
  margin-bottom: 2.5rem;
}

.product-featured-image img {
  width: 100%;
  height: auto;
  display: block;
  border-radius: 18px;
}

/* ===============================
   PRODUCT GALLERY GRID
   =============================== */
.product-gallery-section {
  margin-bottom: 3rem;
}

.product-gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1.25rem;
}

.product-gallery-item img {
  width: 100%;
  height: auto;
  display: block;
  border-radius: 14px;
}
</style>
