<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Customize My Charm/Pendant</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;margin:20px;max-width:900px}
h1{margin:0 0 8px}
.summary{background:#101010;color:#fff;padding:12px 16px;border-radius:8px;display:flex;justify-content:space-between;align-items:center}
.panel{border:1px solid #ddd;border-radius:8px;padding:14px;margin:14px 0}
.row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
label{display:block;margin:8px 0 4px}
input[type=number]{width:100%}
.breakdown{background:#f9f9f9;border:1px solid #ddd;border-radius:8px;padding:12px}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid #eee;padding:8px;text-align:left}
.actions{display:flex;gap:10px;margin-top:12px}
.btn{padding:10px 14px;border-radius:6px;border:none;cursor:pointer}
.btn.primary{background:#111;color:#fff}
.btn.secondary{background:#777;color:#fff}
a{color:#111}
@media(max-width:820px){.row{grid-template-columns:1fr}}
</style>
</head>
<body>
<h1>Customize My Charm/Pendant</h1>
<div class="summary"><div><b id="prodName">Charm</b> • <span id="sizeSummary">—</span></div><div>Total: $<span id="total">0</span></div></div>

<div class="panel">
  <div class="row">
    <div>
      <label>Size</label>
      <select id="size">
        <option value="dime" data-price="13">Dime — 17.9mm — $13</option>
        <option value="penny" data-price="15">Penny — 19mm — $15</option>
        <option value="nickel" data-price="18">Nickel — 21.2mm — $18</option>
        <option value="quarter" data-price="26">Quarter — 24.3mm — $26</option>
        <option value="lin" data-price="33">1 in — 25.4mm — $33</option>
        <option value="half" data-price="37">Half Dollar — 30.6mm — $37</option>
        <option value="1_5in" data-price="58">1.5 in — 38.1mm — $58</option>
        <option value="2in" data-price="103">2 in — 50.8mm — $103</option>
        <option value="2_5in" data-price="161">2.5 in — 63.5mm — $161</option>
      </select>
    </div>
    <div>
      <label>Design Fee (base)</label>
      <input type="number" id="designFee" min="0" value="25">
      <small>Varies by complexity; you control this</small>
    </div>
  </div>
</div>

<div class="panel">
  <h3>Options</h3>
  <div class="row">
    <div><label><input type="checkbox" id="beading" data-price="30"> Beading (+$30)</label></div>
    <div><label><input type="checkbox" id="pattern" data-price="45"> Engraved pattern (+$45)</label></div>
    <div><label><input type="checkbox" id="bale" data-price="10"> Bale for chain (+$10)</label> <small>(Jump ring included)</small></div>
    <div><label><input type="checkbox" id="cutout" data-price="4"> Cut‑out (+$4)</label></div>
  </div>
</div>

<div class="panel">
  <h3>Text & Symbols</h3>
  <div class="row">
    <div>
      <label>Engraving inside/back (words/symbols)</label>
      <input type="number" id="engrave" min="0" value="0">
    </div>
  </div>
  <small>$4 per word/symbol • Embossed/engraved decided during proofing</small>
</div>

<div class="breakdown">
  <table class="table" id="lines"><thead><tr><th>Item</th><th>Amt</th></tr></thead><tbody></tbody><tfoot><tr><th>Total</th><th id="linesTotal">$0</th></tr></tfoot></table>
</div>

<div class="actions">
  <button class="btn primary" id="resetBtn">Reset to Defaults</button>
  <a class="btn secondary" href="collections/charms/shop_all.html">Back to Shop All Charms</a>
  <button class="btn" id="saveBtn">Save My Customization</button>
</div>

<script>
const q = new URLSearchParams(location.search);
const defaults = {
  product: q.get('product') || 'Charm/Pendant',
  size: q.get('size') || 'penny',
  design_fee: parseInt(q.get('design_fee')||'25',10),
  beading: q.get('beading') === '1',
  pattern: q.get('pattern') === '1',
  bale: q.get('bale') === '1',
  cutout: q.get('cutout') === '1',
  engrave: parseInt(q.get('engraving_words')||'0',10)
};

const prodName = document.getElementById('prodName');
const sizeSel = document.getElementById('size');
const designFee = document.getElementById('designFee');
const beading = document.getElementById('beading');
const pattern = document.getElementById('pattern');
const bale = document.getElementById('bale');
const cutout = document.getElementById('cutout');
const engrave = document.getElementById('engrave');
const totalEl = document.getElementById('total');
const sizeSummary = document.getElementById('sizeSummary');
const linesBody = document.querySelector('#lines tbody');
const linesTotal = document.getElementById('linesTotal');
const resetBtn = document.getElementById('resetBtn');
const saveBtn = document.getElementById('saveBtn');

function applyDefaults(){
  prodName.textContent = defaults.product;
  sizeSel.value = defaults.size;
  designFee.value = defaults.design_fee;
  beading.checked = defaults.beading;
  pattern.checked = defaults.pattern;
  bale.checked = defaults.bale;
  cutout.checked = defaults.cutout;
  engrave.value = defaults.engrave;
  recalc();
}

function addLine(name, amt){
  const tr = document.createElement('tr');
  const td1=document.createElement('td'), td2=document.createElement('td');
  td1.textContent = name; td2.textContent = '$'+amt;
  tr.appendChild(td1); tr.appendChild(td2);
  linesBody.appendChild(tr);
  return amt;
}

function recalc(){
  linesBody.innerHTML='';
  let total=0;

  const sizeOpt = sizeSel.options[sizeSel.selectedIndex];
  const base = parseInt(sizeOpt.dataset.price,10);
  const sizeText = sizeOpt.textContent;
  total += addLine('Base size: '+sizeText, base);

  const df = parseInt(designFee.value||'0',10);
  if(df>0){ total += addLine('Design fee', df); }

  if(beading.checked) total += addLine('Beading', parseInt(beading.dataset.price,10));
  if(pattern.checked) total += addLine('Engraved pattern', parseInt(pattern.dataset.price,10));
  if(bale.checked) total += addLine('Bale for chain', parseInt(bale.dataset.price,10));
  if(cutout.checked) total += addLine('Cut-out', parseInt(cutout.dataset.price,10));

  const e = parseInt(engrave.value||'0',10);
  if(e>0){ total += addLine('Engraving x'+e+' @ $4', 4*e); }

  totalEl.textContent = total;
  linesTotal.textContent = '$'+total;
  sizeSummary.textContent = sizeText.split('—')[0].trim();
}

['change','input'].forEach(evt=>document.body.addEventListener(evt,e=>{if(e.target.matches('input,select')) recalc();}));

resetBtn.addEventListener('click', e=>{ e.preventDefault(); applyDefaults(); });

saveBtn.addEventListener('click', e=>{
  e.preventDefault();
  const data = {
    product: prodName.textContent,
    size: sizeSel.value,
    design_fee: parseInt(designFee.value||'0',10),
    beading: beading.checked,
    pattern: pattern.checked,
    bale: bale.checked,
    cutout: cutout.checked,
    engraving_words: parseInt(engrave.value||'0',10),
    total: totalEl.textContent
  };
  const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = (data.product.replace(/\s+/g,'_')||'charm') + '_customization.json';
  a.click();
});

applyDefaults();
</script>
</body></html>
